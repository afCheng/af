webpackJsonp([7],{GF4k:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r("mvHQ"),s=r.n(o),a={data:function(){return{departsId:[],departs:[],departInfo:"",token:"",checked:!1,ruleForm:{user:"",department:"",password:"",type:[]},rules:{user:[{required:!0,message:"请输入账号",trigger:"blur"}],department:[{required:!0,message:"请选择部门",trigger:"change"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],type:[{trigger:"blur"}]}}},created:function(){},mounted:function(){this.getCookie()},methods:{getDepart:function(e){var t=this;this.departInfo=[],this.departs=[],""!=e?this.$axios.post("/api/my-section",{name:e}).then(function(e){var r=[];t.departInfo=e.data.data;for(var o=0;o<e.data.data.length;o++)r.push(e.data.data[o].section.section_one+e.data.data[o].section.section_two);t.departs=r}).catch(function(e){}):(this.departInfo=[],this.departs=[],this.ruleForm.department="")},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;for(var r=0;r<t.departInfo.length;r++)t.departInfo[r].section.section_one+t.departInfo[r].section.section_two==t.ruleForm.department&&(t.departsId=t.departInfo[r].section_id);var o=t.ruleForm.user,a=t.ruleForm.department,n=t.departsId,i=t.ruleForm.password;t.checked;1==t.checked?(t.setCookie(o,a,n,i),window.document.cookie="usercheck=true;path=/;",t.getCookie()):(t.clearCookie(),window.document.cookie="usercheck=false;path=/;"),t.$axios.post("/api/login",{section_id:t.departsId,name:t.ruleForm.user,password:t.ruleForm.password}).then(function(e){"0"==e.data.status?(localStorage.setItem("user",s()(e.data.data)),t.$router.push("/")):t.$message({message:e.data.message,type:"warning"})}).catch(function(e){console.log(e)})})},setCookie:function(e,t,r,o){window.document.cookie="userName="+e+";path=/;",window.document.cookie="userdept="+t+";path=/;",window.document.cookie="userdeptId="+r+";path=/;",window.document.cookie="userPwd="+o+";path=/;"},getCookie:function(){if(document.cookie.length>0)for(var e=document.cookie.split("; "),t=0;t<e.length;t++){var r=e[t].split("=");"userName"==r[0]?this.ruleForm.user=r[1]:"userdept"==r[0]?this.ruleForm.department=r[1]:"userdeptId"==r[0]?this.departsId=r[1]:"userPwd"==r[0]?this.ruleForm.password=r[1]:"usercheck"==r[0]&&(this.checked=r[1])}},clearCookie:function(){this.setCookie("","","","")}}},n={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"loginWrap"},[o("img",{attrs:{src:r("JiZG")}}),e._v(" "),o("div",{staticClass:"log"},[o("div",{staticClass:"login"},[o("h3",[e._v("应急演练系统平台")]),e._v(" "),o("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[o("el-form-item",{attrs:{prop:"user"}},[o("div",{staticClass:"pic"},[o("i",{staticClass:"iconfont el-icon-emergency-zhanghao"})]),e._v(" "),o("el-input",{attrs:{placeholder:"账号"},nativeOn:{keyup:function(t){e.getDepart(e.ruleForm.user)}},model:{value:e.ruleForm.user,callback:function(t){e.$set(e.ruleForm,"user",t)},expression:"ruleForm.user"}})],1),e._v(" "),o("el-form-item",{staticStyle:{"margin-right":"58px",height:"36px"},attrs:{prop:"department"}},[o("el-select",{attrs:{placeholder:"选择部门"},model:{value:e.ruleForm.department,callback:function(t){e.$set(e.ruleForm,"department",t)},expression:"ruleForm.department"}},e._l(e.departs,function(e,t){return o("el-option",{key:t,attrs:{label:e,value:e}})}))],1),e._v(" "),o("el-form-item",{attrs:{prop:"password"}},[o("div",{staticClass:"pic"},[o("i",{staticClass:"iconfont el-icon-emergency-mima"})]),e._v(" "),o("el-input",{attrs:{placeholder:"密码",type:"password"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.submitForm("ruleForm")}},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1)],1),e._v(" "),o("button",{staticClass:"btnLogin",on:{click:function(t){e.submitForm("ruleForm")}}},[e._v("登录")])],1)])])},staticRenderFns:[]};var i=r("VU/8")(a,n,!1,function(e){r("pTF5")},null,null);t.default=i.exports},JiZG:function(e,t,r){e.exports=r.p+"static/img/bg3.b83c98c.png"},pTF5:function(e,t){}});
//# sourceMappingURL=7.8c0c60eec223d5daa429.js.map